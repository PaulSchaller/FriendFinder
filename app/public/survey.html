<!DOCTYPE html>
    <html>

<!--added links and bootstrap for my html page for the survey-->
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Page Title</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
        <script src="https://code.jquery.com/jquery.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

<!--added some css styling for the match result page/pop-up-->
        <style>
           
            #resultsContainer {
              background-color: green;
              color: black;
              display: none;
            }

            .resultsStyling1 {
              font-size: 100px;
            }

            
        </style>

    </head>

<!--starting the body of the program.-->
    <body>
<!--my survey page will have entry fields for name and photo and then 10
questions-->    
    <div class="container" id = "mainContainer">
    <h2>Survey Questions</h2>
    <br>
    <h3><strong>About You</strong></h3>
    <h4>Name (Required)</h4>
    <input type="text" name="" id="name" class="form-control" required="">
    <h4>Link to Photo Image (Required)</h4>
    <input type="text" name="" id="photo" class="form-control" required="">
    <br>

    <div id="questions" class="container col-sm-12">
        <div class='row'>
          <form>
            <p class="question">1. You like sports.</p>
            <ul class="answers">
            <input type='radio' name='question1' value='1' id='question1(a)'><label for='question1(a)'>1 (Strongly Disagree)</label><br>
            <input type='radio' name='question1' value='2' id='question1(b)'><label for='question1(b)'>2</label><br>
            <input type='radio' name='question1' value='3' id='question1(c)'><label for='question1(c)'>3</label><br>
            <input type='radio' name='question1' value='4' id='question1(d)'><label for='question1(d)'>4</label><br>
            <input type='radio' name='question1' value='5' id='question1(e)'><label for='question1(e)'>5 (Strongly Agree)</label><br>
            </ul>
        </div>
        <div class='row'>
            <p class="question">2. You like cold weather.</p>
            <ul class="answers">
            <input type='radio' name='question2' value='1' id='question2(a)'><label for='question2(a)'>1 (Strongly Disagree)</label><br>
            <input type='radio' name='question2' value='2' id='question2(b)'><label for='question2(b)'>2</label><br>
            <input type='radio' name='question2' value='3' id='question2(c)'><label for='question2(c)'>3</label><br>
            <input type='radio' name='question2' value='4' id='question2(d)'><label for='question2(d)'>4</label><br>
            <input type='radio' name='question2' value='5' id='question2(e)'><label for='question2(e)'>5 (Strongly Agree)</label><br>
            </ul>
        </div>
        <div class='row'>
            <p class="question">3. You find it easy to stay relaxed and focused even when there is some pressure.</p>
            <ul class="answers">
            <input type='radio' name='question3' value='1' id='question3(a)'><label for='question3(a)'>1 (Strongly Disagree)</label><br>
            <input type='radio' name='question3' value='2' id='question3(b)'><label for='questio3(b)'>2</label><br>
            <input type='radio' name='question3' value='3' id='question3(c)'><label for='question3(c)'>3</label><br>
            <input type='radio' name='question3' value='4' id='question3(d)'><label for='question3(d)'>4</label><br>
            <input type='radio' name='question3' value='5' id='question3(e)'><label for='question3(e)'>5 (Strongly Agree)</label><br>
            </ul>
        </div>
        <div class='row'>
            <p class="question">4. You like working by yourself.</p>
            <ul class="answers">
            <input type='radio' name='question4' value='1' id='question4(a)'><label for='question4(a)'>1 (Strongly Disagree)</label><br>
            <input type='radio' name='question4' value='2' id='question4(b)'><label for='question4(b)'>2</label><br>
            <input type='radio' name='question4' value='3' id='question4(c)'><label for='question4(c)'>3</label><br>
            <input type='radio' name='question4' value='4' id='question4(d)'><label for='question4(d)'>4</label><br>
            <input type='radio' name='question4' value='5' id='question4(e)'><label for='question4(e)'>5 (Strongly Agree)</label><br>
            </ul>
        </div>
        <div class='row'>
            <p class="question">5. It is often difficult for you to relate to other people’s feelings.</p>
            <ul class="answers">
            <input type='radio' name='question5' value='1' id='question5(a)'><label for='question5(a)'>1 (Strongly Disagree)</label><br>
            <input type='radio' name='question5' value='2' id='question5(b)'><label for='question5(b)'>2</label><br>
            <input type='radio' name='question5' value='3' id='question5(c)'><label for='question5(c)'>3</label><br>
            <input type='radio' name='question5' value='4' id='question5(d)'><label for='question5(d)'>4</label><br>
            <input type='radio' name='question5' value='5' id='question5(e)'><label for='question5(e)'>5 (Strongly Agree)</label><br>
            </ul>
        </div>
        <div class='row'>
            <p class="question">6. You enjoy movies.</p>
            <ul class="answers">
            <input type='radio' name='question6' value='1' id='question6(a)'><label for='question6(a)'>1 (Strongly Disagree)</label><br>
            <input type='radio' name='question6' value='2' id='question6(b)'><label for='question6(b)'>2</label><br>
            <input type='radio' name='question6' value='3' id='question6(c)'><label for='question6(c)'>3</label><br>
            <input type='radio' name='question6' value='4' id='question6(d)'><label for='question6(d)'>4</label><br>
            <input type='radio' name='question6' value='5' id='question6(e)'><label for='question6(e)'>5 (Strongly Agree)</label><br>
            </ul>
        </div>
        <div class='row'>
            <p class="question">7. You like to read novels.</p>
            <ul class="answers">
            <input type='radio' name='question7' value='1' id='question7(a)'><label for='question7(a)'>1 (Strongly Disagree)</label><br>
            <input type='radio' name='question7' value='2' id='question7(b)'><label for='question7(b)'>2</label><br>
            <input type='radio' name='question7' value='3' id='question7(c)'><label for='question7(c)'>3</label><br>
            <input type='radio' name='question7' value='4' id='question7(d)'><label for='question7(d)'>4</label><br>
            <input type='radio' name='question7' value='5' id='question7(e)'><label for='question7(e)'>5 (Strongly Agree)</label><br>
            </ul>
        </div>
        <div class='row'>
            <p class="question">8. In a discussion, truth should be more important than people’s sensitivities..</p>
            <ul class="answers">
            <input type='radio' name='question8' value='1' id='question8(a)'><label for='question8(a)'>1 (Strongly Disagree)</label><br>
            <input type='radio' name='question8' value='2' id='question8(b)'><label for='question8(b)'>2</label><br>
            <input type='radio' name='question8' value='3' id='question8(c)'><label for='question8(c)'>3</label><br>
            <input type='radio' name='question8' value='4' id='question8(d)'><label for='question8(d)'>4</label><br>
            <input type='radio' name='question8' value='5' id='question8(e)'><label for='question8(e)'>5 (Strongly Agree)</label><br>
            </ul>
        </div>
        <div class='row'>
            <p class="question">9. You think that everyone’s views should be respected regardless of whether they are supported by facts or not.</p>
            <ul class="answers">
            <input type='radio' name='question9' value='1' id='question9(a)'><label for='question9(a)'>1 (Strongly Disagree)</label><br>
            <input type='radio' name='question9' value='2' id='question9(b)'><label for='question9(b)'>2</label><br>
            <input type='radio' name='question9' value='3' id='question9(c)'><label for='question9(c)'>3</label><br>
            <input type='radio' name='question9' value='4' id='question9(d)'><label for='question9(d)'>4</label><br>
            <input type='radio' name='question9' value='5' id='question9(e)'><label for='question9(e)'>5 (Strongly Agree)</label><br>
            </ul>
        </div>
        <div class='row'>
            <p class="question">10. You rarely get carried away by fantasies and ideas.</p>
            <ul class="answers">
            <input type='radio' name='question10' value='1' id='question10(a)'><label for='question10(a)'>1 (Strongly Disagree)</label><br>
            <input type='radio' name='question10' value='2' id='question10(b)'><label for='question10(b)'>2</label><br>
            <input type='radio' name='question10' value='3' id='question10(c)'><label for='question10(c)'>3</label><br>
            <input type='radio' name='question10' value='4' id='question10(d)'><label for='question10(d)'>4</label><br>
            <input type='radio' name='question10' value='5' id='question10(e)'><label for='question10(e)'>5 (Strongly Agree)</label><br>
            </ul>
        </div>
    </div>
                <br><br>

<!--I end the survey html with a submit button which submits the answers to
the survey for analysis-->
    <button type="button" class="btn btn-lg" id="submit" style="background-color: blue">SUBMIT</button>
    </form>
  </div>


<!--this is the html for the pop-up window that shows up with the 
results of the survey analysis-->
<div class="container" id = "resultsContainer">
    <div class = "row">
    <h1><strong>Best Match</strong></h1>
    </div>

    <br><br>

    <div class = "row">
      <div class = "resultsStyling1" id = "nameOfBestMatch"></div>
    </div>

    <br><br>

    <div class = "row">
    <h3>For a photo of your friend match, go to the API Friends List</h3>
      <div class="col-lg-6"> 
        <a href="/api/friends"><button type="button" class="btn btn-lg btn-danger">API Friends List</button></a> 
      </div>
    </div>
    
    <br><br><br><br><br>
    
    <div class = "row">
      <div class="col-lg-6">
         <button type="button" class="btn btn-lg" id="close">Close</button>
      </div> 
      <div class="col-lg-6">
         <img class="" id="" alt="Friends" src="https://logos.textgiraffe.com/logos/logo-name/Friends-designstyle-friends-m.png" >
      </div>
    </div>

  </div>
 

<!--I now include the javasript relating to the survey in the body of the 
survey html page-->
<script type="text/javascript">
   //I declare a global array that will be used to store the friends data
   //once this data is retrieved for the friends.js file  
   var arrFriends = [];

    //the submit button is the powerhouse of the program
    //the submit button will execute the program through to the results
    //window
    $("#submit").on("click", function(event) {

      event.preventDefault();

      //if any survey question is not answered, the user will be alerted
      // of the problem until the problem is corrected
      if ( !$("input[name=question1]:checked").val()  ||
           !$("input[name=question2]:checked").val()  ||
           !$("input[name=question3]:checked").val()  ||
           !$("input[name=question4]:checked").val()  ||
           !$("input[name=question5]:checked").val()  ||
           !$("input[name=question6]:checked").val()  ||
           !$("input[name=question7]:checked").val()  ||
           !$("input[name=question8]:checked").val()  ||
           !$("input[name=question9]:checked").val()  ||
           !$("input[name=question10]:checked").val() 
          ) {
        alert("You need to answer each question.");
        return;
      }


      // Here we grab the survey form elements
      //the form elements are saved in a variable newFriend
      var newFriend = {
        name: $("#name").val().trim(),
        photo: $("#photo").val().trim(),
        scores : []
      }

      for (var i = 1; i < 11; i++) {
        scoreInput = $("input[name=question"+i+"]:checked").val();
        newFriend.scores.push(scoreInput);
      };


      //a new entry is posted into the friends.js database (storage)
      $.post("/api/friends", newFriend,
        function(data) {
          if (data) {
            alert("Yay! You are added to the database!");
          }
        

        // the survey form is then cleared
          $("#name").val("");
          $("#photo").val("");
          $("input[name=question1]:checked").val("");
          $("input[name=question2]:checked").val("");
          $("input[name=question3]:checked").val("");
          $("input[name=question4]:checked").val("");
          $("input[name=question5]:checked").val("");
          $("input[name=question6]:checked").val("");
          $("input[name=question7]:checked").val("");
          $("input[name=question8]:checked").val("");
          $("input[name=question9]:checked").val("");
          $("input[name=question10]:checked").val("");

        });

      //a function call to get the data from the friend.js file
      getFriendData(newFriend);

    });

  
//this is the function that was just called
//this function is a GET function that retrieves data from a file and
//stores this data in an array arrFriends
    function getFriendData(newFriend) {


    $.get("/api/friends", function (friends) {
        arrFriends = friends;
        //the function to calculate the results is called from this function
        //this function call passes arrFriends and newFriend to the function
        calculateFriendMatch(arrFriends, newFriend);
        });
      };



    function calculateFriendMatch(arrFriends, newFriend) {

      var accumulatedDifference = [];
      var a = 0;
      var leastDifferenceAmount = 0;

      //for loop to initialize a variable (array)
      for (var i = 0; i < arrFriends.length - 1; i++) {
          accumulatedDifference[i] = 0;
          }

      //for loop to determine the amounts of differences in the survey answers
      //between the participants
      for (var i = 0; i < arrFriends.length - 1; i++) {
          for (var g = 0; g < 10; g++) {
            var difference = Math.abs(arrFriends[i].scores[g] - newFriend.scores[g]);
              accumulatedDifference[i] += difference;
            }   
        }

      //the person with the least amount of difference in the survey
      //answers is determined 
      if (accumulatedDifference[0] < accumulatedDifference[1]) {
          a = 0;
          leastDifferenceAmount = accumulatedDifference[0];
        }
      else { 
          a = 1;
          leastDifferenceAmount = accumulatedDifference[1];
        }

      for (var i = 2; i < arrFriends.length - 1; i++) {
        if (accumulatedDifference[i] < leastDifferenceAmount)
          {
            accumulatedDifference[i] = leastDifferenceAmount;
            a = i;
            }
       }


      //the best match has been calculated and the result is stored
      //in arrFriends[a] 
      var bestMatch = arrFriends[a];
    
      //the result is loaded onto the DOM results page
      $("#nameOfBestMatch").text(bestMatch.name);

      $("#close").on("click", function(event) {
          event.preventDefault();
          $('#resultsContainer').hide();
          $('#mainContainer').show();
        });

      //the results window is displayed and the survey page is hidden
      $('#resultsContainer').show();
      $('#mainContainer').hide();
    }
  
    //the preceding function definition concludes the script section for this
    //html page  
    </script>

<!--the page is closed up-->
</body>

</html>